# Proportion of negative values from a normal distribution

## Invariability of the proportion of negative values
For a given normal distribution with mean $\mu$ and standard deviation $\sigma$, the proportion of negative values does not change when $\mu$ and $\sigma$ are multiplied by the same positive constant:
```{r}
pnorm(0,mean=5.3,sd=2.1)
multi.factors <- runif(100,0,100) # generate random multiplication factors
prop.zeroes <- pnorm(0,mean=multi.factors*5.3,sd=multi.factors*2.1)
var(prop.zeroes) # no variation in proportion of zeroes!
```

If we find one combination of mean and standard deviation that satisfies a certain fraction of negative values, we can thus generate infinitely many combinations that satisfy these conditions, simply by multiplying both mean and standard deviation with the same positive constant.

## Adapting the mean to find a given proportion of negative values
Assume we want to find a distribution with a certain proportion of zeroes, $p_0$, and a set standard deviation $\sigma$. We can proceed as follows:

* Pick an arbitrary starting value for the mean $\mu_0$
* Use \tettt{qnorm} to determine for the distribution with mean $\mu_0$ and standard deviation $\sigma$ at which cut-off value the fraction of random numbers below the cut-off is equal to $p_0$.
* Shift the mean with that value, such that the cut-off aligns with the 0 point.
* You have found the distribution that you need!

An example: assume we want to find the mean of a distribution for which $\sigma=0.2$ and a proportion of $p_0=0.21$ of the random draws is negative:
```{r}
mu_0 <- 5.67 # determine a random m_0
dmu <- qnorm(0.21,mean=mu_0,sd=0.2)
dmu # a fraction of 0.21 of the points is below this cut-off
mu <- mu_0 - dmu # we shift the whole distribution
pnorm(0,mu,0.2) # we found a distribution for which exactly 21% of the datapoints are below zero!

# it has mean:
mu
# and standard deviation (as predefined)
0.2

```
## Adapting the standard deviation
We can adapt the above procedure to find the standard deviation $\sigma$ for which a certain proportion $p_0$ of the data points is negative, given a predefined mean value of the distribution of $\mu$.

* Pick an arbitrary starting value for the mean $\mu_0$ and the standard deviation $\sigma_0$
* Use \tettt{qnorm} to determine for the distribution with mean $\mu_0$ and standard deviation $\sigma_0$ at which cut-off value the fraction of random numbers below the cut-off is equal to $p_0$.
* Shift the mean with that value, such that the cut-off aligns with the 0 point, this give $\mu_0^\prime$.
* Multiply both $\sigma_0$ and $\mu_0^\prime$ with $\frac{mu}{\mu_0^\prime}$ to find the distribution that you need.

An example: assume we want to find the standard deviation of a distribution for which $\mu=3.4$ and a proportion of $p_0=0.17$ of the random draws is negative:
```{r}
mu_0 <- 2.45 # determine a random m_0
sd_0 <- 1.14
p_0 <- 0.17
dmu <- qnorm(p_0,mean=mu_0,sd=sd_0)
dmu # a fraction of 0.21 of the points is below this cut-off
mu_0p <- mu_0 - dmu # we shift the whole distribution
mu <- 3.4 # the mean value that we would want to have
mu <- mu_0p * (mu/mu_0p)# Multiply the temporary values of mu and sd with a factor to match the predefined mean
sd <- sd_0 *(mu/mu_0p)

pnorm(0,mu,sd) # we found a distribution for which exactly 17% of the datapoints are below zero!

# it has mean (as predefined):
mu
# and standard deviation:
sd

```
## Simplified
We can simplify the procedure in the previous section by starting with the standard normal distribution with $\mu_0=0$ and $\sigma_0=1$. Let's say we want to find a proportion of $p_0=0.06$ negative values with $\mu=1.2$:
```{r}
p_0 <- 0.06
mu_0p <- -qnorm(p_0,0,1)
mu_0p # the mu necessary for p_0=0.06, when sigma=1
# therefore also equal to the ratio mu/sigma such that p_0 = 0.06

mu <- 1.2 # the mean value that we would want to have
mu <- mu_0p * (mu/mu_0p)# Multiply the temporary values of mu and sd with a factor to match the predefined mean
sd <- (mu/mu_0p)

pnorm(0,mu,sd) # we found a distribution for which exactly 17% of the datapoints are below zero!

# it has mean (as predefined):
mu
# and standard deviation:
sd

```

## Matching an empirical distribution
The means above are all based on the means of full distributions, including the negative values. How can one approximately match a distribution that was generated by drawing random numbers from a normal distribution and then setting all negative values to 0? If the proportion of negative values is smaller than 50%, one can obtain a rough approximation of the mean by removing the same percentage of high values from the data and calculate the mean on the remaining data. For example:
```{r}
# generate data from a normal distribution (1000 datpoints):
x <- rnorm(1000,mean=0.45,sd=0.85) # we want to find this mean and sd back
x[x<0] <- 0 # all negative values are set to 0
sd(x)
mean(x)
# we note that the sd and mean of these values are way off
```
Now that we have some dummy data, how can we find the mean and sd values back?
```{r}
# calculate the proportion of zereos:
p_0 <- mean(x==0)
p_0

# Remove the same fraction of points on the high side
# and calculate the mean for the remaining values
q1 <- quantile(x,probs=1-p_0)
mu_approx <- mean(x[x>0 & x <q1]) # a pretty okay approximation!
mu_approx

# now we want to calculate the necessary sd such that a proportion p_0 for a distribution with mean mu_approx is below 0
multip <- -qnorm(p_0) # the factor between mu and sd
sd_approx <- mu_approx/multip
sd_approx # a very fair approximation of the standard deviation!

```
There must be better ways to achieve this, if you know a good method, please let me know!
